# ULPGC eduroam fixer for Linux

This repo contains a small **bash** helper script to fix eduroam on Linux at ULPGC after running the official eduroam CAT installer.  
It simply adjusts the NetworkManager 802.1X settings for the existing `eduroam` connection so that the correct CA certificate and domain are used.

> ⚠️ This is an **unofficial** tool. It is not affiliated with ULPGC, eduroam, or GEANT. Use at your own risk.

---

## What this script does

- Assumes you already ran the official eduroam CAT installer for ULPGC and have a working `eduroam` profile in NetworkManager.  
- Locates the CA certificate generated by CAT at `~/.config/cat_installer/ca.pem`.  
- Updates the existing `eduroam` connection in NetworkManager via `nmcli`:
  - Sets `802-1x.ca-cert` to the CAT-generated `ca.pem`.  
  - Clears `802-1x.altsubject-matches`.  
  - Sets `802-1x.domain-suffix-match` to `ulpgc.es`.  
- Prints the relevant 802.1X settings for `eduroam` so you can verify them.  
- Shows optional commands to store your password and bring the connection up.

The script does **not** create a new Wi‑Fi profile, change your username, or touch other connections.

---

## Requirements

- Linux distribution using NetworkManager (Ubuntu, Fedora, etc.).  
- `nmcli` available (part of NetworkManager).  
- You must have already:
  - Downloaded the ULPGC eduroam installer from the eduroam CAT website.  
  - Run the installer once under the same user that will run this script (so `~/.config/cat_installer/ca.pem` exists).  
- `sudo` access (the script calls `nmcli connection modify` with `sudo`).

---

## Step 1 – Run the official ULPGC eduroam installer (once)

1. Go to the eduroam CAT site and select ULPGC as your institution.  
2. Download the **Linux** installer for ULPGC; you will get a file similar to `eduroam-linux-UdLPdGC.py`.  
3. In a terminal, run:

```bash
cd ~/Downloads
chmod +x eduroam-linux-*.py
./eduroam-linux-*.py
```

Follow the prompts until it reports that configuration was successful and you see an `eduroam` connection in your NetworkManager Wi‑Fi list.

---

## Step 2 – Download this fixer script

From the repository page, download `eduroam-fixer.sh` (or clone the repo):

```bash
git clone https://github.com/Lainer2/ULPGC-EDUROAM-FIX-For-Linux-.git
cd ULPGC-EDUROAM-FIX-For-Linux-
chmod +x eduroam-fixer.sh
```

(If you named the script differently, adjust the filename.)

---

## Step 3 – Run the fixer

Run the script from the same user that ran the CAT installer:

```bash
./eduroam-fixer.sh
```

What will happen:

- If no `eduroam` connection exists, the script stops and tells you to run the CAT installer first.  
- If `~/.config/cat_installer/ca.pem` is missing, it stops and tells you to re‑run the installer.  
- Otherwise, it will ask for your password (for `sudo`), update the NetworkManager settings, and print the new values for:
  - `802-1x.ca-cert`  
  - `802-1x.altsubject-matches`  
  - `802-1x.domain-suffix-match`  

You should see `ulpgc.es` as the domain suffix.

---

## Step 4 – Connect to eduroam

On campus, you can either use your desktop environment's Wi‑Fi menu or run:

```bash
nmcli --ask connection up eduroam
```

If you didn't store your password, `nmcli` will prompt for your eduroam credentials.

### Optional: Store your password permanently

To avoid typing your password every time, you can store it in the NetworkManager profile:

```bash
sudo nmcli connection modify eduroam \
  802-1x.password "YOUR_PASSWORD" \
  802-1x.password-flags 0
```

**Note:** This stores your password encrypted but retrievable on the machine. Anyone with root access can potentially read it.

---

## The fixer script

Here's the complete script for reference. Save it as `eduroam-fixer.sh`:

```bash
#!/usr/bin/env bash
set -e

echo "== LAINER'S eduroam Linux fixer =="

if ! nmcli -t -f NAME connection show | grep -qx "eduroam"; then
    echo "Error: No 'eduroam' connection found in NetworkManager."
    echo "Run the official ULPGC eduroam CAT installer first, then re-run this script."
    exit 1
fi

CA_PATH="$HOME/.config/cat_installer/ca.pem"
if [ ! -f "$CA_PATH" ]; then
    echo "Error: $CA_PATH not found."
    echo "Make sure you have run the ULPGC eduroam CAT installer on this user account."
    exit 1
fi

echo "Found eduroam profile and CA certificate."

echo "Applying NetworkManager 802.1X settings for ULPGC eduroam..."

sudo nmcli connection modify eduroam \
    802-1x.ca-cert "$CA_PATH" \
    802-1x.altsubject-matches "" \
    802-1x.domain-suffix-match "ulpgc.es"

echo
echo "Done. Current relevant settings:"
nmcli connection show eduroam | grep -iE 'ca-cert|altsubject|domain-suffix' || true

echo
echo "Optional: to store your eduroam password, run:"
echo '  sudo nmcli connection modify eduroam 802-1x.password "YOUR_PASSWORD" 802-1x.password-flags 0'
echo
echo "To connect now (on campus), run:"
echo "  nmcli --ask connection up eduroam"
```

---

## Troubleshooting

### "Error: No 'eduroam' connection found in NetworkManager."

- The CAT installer did not create an `eduroam` profile or you ran it as a different user.  
- Solution: Re‑run the official ULPGC installer and ensure you see `eduroam` when you run `nmcli connection show`.  

### "Error: ~/.config/cat_installer/ca.pem not found."

- The CAT installer was not run for this user or failed to write the CA file.  
- Solution: Run the CAT installer again and verify the file exists with `ls ~/.config/cat_installer`.  

### Still cannot connect

- Double‑check your username format and password according to ULPGC's official eduroam instructions.  
- Try deleting and reinstalling the eduroam profile using CAT, then re‑run this script.  
- Check NetworkManager logs for more details:

```bash
journalctl -u NetworkManager
```

---

## Security and privacy notes

- The script only adjusts settings for the existing `eduroam` connection and does not send your credentials anywhere.  
- If you choose to store your password using `nmcli` with `password-flags 0`, it will be saved in NetworkManager's system keyring; anyone with root access can potentially read it.  
- Always download the official ULPGC installer only from the eduroam CAT or official ULPGC IT pages.
- This script requires `sudo` to modify NetworkManager connections. Review the script before running it if you have security concerns.

---

## Contributing

Found a bug or have a suggestion? Feel free to open an issue or submit a pull request!

---

## License

This project is provided as-is under the MIT License. See LICENSE file for details.

---

## Acknowledgments

- Thanks to the eduroam CAT team for providing the official installers.
- Thanks to ULPGC IT services for maintaining the eduroam infrastructure.

---

**Repo:** https://github.com/Lainer2/ULPGC-EDUROAM-FIX-For-Linux-%  
